(()=>{"use strict";const e=window.wp.primitives,t=window.ReactJSXRuntime,o=(0,t.jsx)(e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(e.Path,{d:"M12 4L4 7.9V20h16V7.9L12 4zm6.5 14.5H14V13h-4v5.5H5.5V8.8L12 5.7l6.5 3.1v9.7z"})}),n=window.wp.blocks,r=window.prcComponents,i=window.React,a=window.wp.coreData,p=window.wp.blockEditor,c=window.wp.components,s=window.wp.data,d="homepage",l=(new Date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"});function m({previewedHomepageId:e,setPreviewedHomepageId:o,clientId:n}){const[p,m]=(0,i.useState)(!1),g=()=>m(!p);return(0,t.jsxs)(i.Fragment,{children:[(0,t.jsx)(c.Button,{variant:"secondary",onClick:g,children:"Create New Draft"}),p&&(0,t.jsx)(r.EntityCreateNewModal,{entityType:"homepage",defaultTitle:`Homepage ${l}`,defaultContent:'\n\x3c!-- wp:group {"layout":{"type":"constrained","contentSize":"1200px"}} --\x3e\n<div class="wp-block-group">\x3c!-- wp:prc-block/grid-controller {"dividerColor":"gray","className":"is-pattern__featured-layout"} --\x3e\n\x3c!-- wp:prc-block/grid-column {"gridLayout":{"index":1,"desktopSpan":"3","tabletSpan":"6","mobileSpan":"4"}} --\x3e\n\x3c!-- wp:prc-block/story-item {"imageSize":"A2","postId":0,"metaTaxonomy":"category"} /--\x3e\n\n\x3c!-- wp:prc-block/story-item {"imageSize":"A2","postId":0,"metaTaxonomy":"category"} /--\x3e\n\x3c!-- /wp:prc-block/grid-column --\x3e\n\n\x3c!-- wp:prc-block/grid-column {"gridLayout":{"index":2,"desktopSpan":"6","tabletSpan":"12","mobileSpan":"4"}} --\x3e\n\x3c!-- wp:prc-block/story-item {"postId":0,"metaTaxonomy":"category"} /--\x3e\n\x3c!-- /wp:prc-block/grid-column --\x3e\n\n\x3c!-- wp:prc-block/grid-column {"gridLayout":{"index":3,"desktopSpan":"3","tabletSpan":"6","mobileSpan":"4"}} --\x3e\n\x3c!-- wp:prc-block/story-item {"imageSize":"A2","postId":0,"metaTaxonomy":"category"} /--\x3e\n\n\x3c!-- wp:prc-block/story-item {"imageSize":"A2","postId":0,"metaTaxonomy":"category"} /--\x3e\n\x3c!-- /wp:prc-block/grid-column --\x3e\n\x3c!-- /wp:prc-block/grid-controller --\x3e</div>\n\x3c!-- /wp:group --\x3e\n',onClose:()=>{g()},onSubmit:(e,t)=>{(async function(e,t,o="draft"){const n={title:e,content:t,status:o},{saveEntityRecord:r}=(0,s.dispatch)(a.store),i=await r("postType",d,n);return!!i&&(console.log("onCreateHomepage",i),i)})(e,t,"draft").then((e=>{console.log("then...",e),o(e.id),g()}))}})]})}const g=window.wp.i18n;function w({previewedHomepageId:e,setPreviewedHomepageId:o,clientId:n}){const[a,p]=(0,i.useState)(!1),s=()=>p(!a);return(0,t.jsxs)(i.Fragment,{children:[(0,t.jsx)(c.Button,{variant:"secondary",onClick:s,children:"Preview Different Homepage"}),a&&(0,t.jsx)(r.EntityPatternModal,{title:(0,g.__)("Preview an existing homepage","prc-platform-homepages"),instructions:(0,g.__)("Select a homepage to preview","prc-platform-homepages"),entityType:"homepage",entityTypeLabel:(0,g.__)("Homepage","prc-platform-homepages"),onSelect:e=>{console.log("On select",e),o(e?.id)},onClose:()=>{s()},status:"draft",selectedId:e,clientId:n})]})}function x({previewedHomepageId:e,setPreviewedHomepageId:o,clientId:n}){return(0,t.jsx)(p.InspectorControls,{children:(0,t.jsxs)(c.PanelBody,{title:"Homepage Options",children:[(0,t.jsx)(c.PanelRow,{children:(0,t.jsx)(w,{previewedHomepageId:e,setPreviewedHomepageId:o,clientId:n})}),(0,t.jsx)(c.PanelRow,{children:(0,t.jsx)(m,{previewedHomepageId:e,setPreviewedHomepageId:o,clientId:n})})]})})}const y=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"prc-platform/latest-homepage","version":"1.0.0","title":"Latest Homepage","description":"Returns the most recently published homepage.","category":"theme","keywords":["homepage","home","front page","frontpage"],"supports":{"anchor":true,"html":false},"usesContext":["queryId","query","queryContext","templateSlug","previewPostType"],"textdomain":"prc-block","editorScript":"file:./index.js"}'),{name:u}=y,h={icon:o,edit:function({clientId:e,context:o}){const[n,c]=(0,i.useState)(),{records:s,hasResolved:l}=(0,a.useEntityRecords)("postType",d,{per_page:1,context:"view",orderby:"date",order:"desc"});(0,i.useEffect)((()=>{0!==s?.length&&l&&s[0].id&&n!==s[0].id&&c(s[0].id)}),[l,s,n]);const m=(0,p.useBlockProps)();return(0,t.jsxs)(i.Fragment,{children:[(0,t.jsx)(x,{previewedHomepageId:n,setPreviewedHomepageId:c,clientId:e}),(0,t.jsx)(r.InnerBlocksAsSyncedContent,{postId:n,postType:d,postTypeLabel:"Homepage",blockProps:m,clientId:e})]})}},I=(0,n.registerBlockType)(u,{...y,...h});console.log("register homepage:",I)})();
//# sourceMappingURL=index.js.map