{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@pewresearch/prc-homepages/external window [\"wp\",\"primitives\"]","webpack://@pewresearch/prc-homepages/external window \"ReactJSXRuntime\"","webpack://@pewresearch/prc-homepages/./node_modules/@wordpress/icons/build-module/library/home.js","webpack://@pewresearch/prc-homepages/external window [\"wp\",\"blocks\"]","webpack://@pewresearch/prc-homepages/external window \"prcComponents\"","webpack://@pewresearch/prc-homepages/external window \"React\"","webpack://@pewresearch/prc-homepages/external window [\"wp\",\"coreData\"]","webpack://@pewresearch/prc-homepages/external window [\"wp\",\"blockEditor\"]","webpack://@pewresearch/prc-homepages/external window [\"wp\",\"components\"]","webpack://@pewresearch/prc-homepages/external window [\"wp\",\"data\"]","webpack://@pewresearch/prc-homepages/./src/constants.js","webpack://@pewresearch/prc-homepages/./src/create-new-homepage-modal.jsx","webpack://@pewresearch/prc-homepages/./src/create-homepage.js","webpack://@pewresearch/prc-homepages/external window [\"wp\",\"i18n\"]","webpack://@pewresearch/prc-homepages/./src/preview-selection-modal.jsx","webpack://@pewresearch/prc-homepages/./src/controls.jsx","webpack://@pewresearch/prc-homepages/./src/index.js","webpack://@pewresearch/prc-homepages/./src/edit.jsx"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"primitives\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"ReactJSXRuntime\"];","/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst home = /*#__PURE__*/_jsx(SVG, {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0 0 24 24\",\n  children: /*#__PURE__*/_jsx(Path, {\n    d: \"M12 4L4 7.9V20h16V7.9L12 4zm6.5 14.5H14V13h-4v5.5H5.5V8.8L12 5.7l6.5 3.1v9.7z\"\n  })\n});\nexport default home;\n//# sourceMappingURL=home.js.map","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blocks\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"prcComponents\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"React\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"coreData\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blockEditor\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"components\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"data\"];","const POST_TYPE = 'homepage';\nconst POST_TYPE_LABEL = 'Homepage';\nconst DEFAULT_CONTENT = `\n<!-- wp:group {\"layout\":{\"type\":\"constrained\",\"contentSize\":\"1200px\"}} -->\n<div class=\"wp-block-group\"><!-- wp:prc-block/grid-controller {\"dividerColor\":\"gray\",\"className\":\"is-pattern__featured-layout\"} -->\n<!-- wp:prc-block/grid-column {\"gridLayout\":{\"index\":1,\"desktopSpan\":\"3\",\"tabletSpan\":\"6\",\"mobileSpan\":\"4\"}} -->\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n<!-- /wp:prc-block/grid-column -->\n\n<!-- wp:prc-block/grid-column {\"gridLayout\":{\"index\":2,\"desktopSpan\":\"6\",\"tabletSpan\":\"12\",\"mobileSpan\":\"4\"}} -->\n<!-- wp:prc-block/story-item {\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n<!-- /wp:prc-block/grid-column -->\n\n<!-- wp:prc-block/grid-column {\"gridLayout\":{\"index\":3,\"desktopSpan\":\"3\",\"tabletSpan\":\"6\",\"mobileSpan\":\"4\"}} -->\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n\n<!-- wp:prc-block/story-item {\"imageSize\":\"A2\",\"postId\":0,\"metaTaxonomy\":\"category\"} /-->\n<!-- /wp:prc-block/grid-column -->\n<!-- /wp:prc-block/grid-controller --></div>\n<!-- /wp:group -->\n`;\n\nexport { POST_TYPE, POST_TYPE_LABEL, DEFAULT_CONTENT };\n","/**\n * External Dependencies\n */\nimport { EntityCreateNewModal } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { useState, Fragment } from 'react';\nimport { Button } from '@wordpress/components';\n\n/**\n * Internal Dependencies\n */\nimport createHomepage from './create-homepage';\nimport { DEFAULT_CONTENT } from './constants';\n\n// get today's date in MM/DD/YYYY format\nconst today = new Date().toLocaleDateString('en-US', {\n\tmonth: '2-digit',\n\tday: '2-digit',\n\tyear: '2-digit',\n});\n\nexport default function CreateNewHomepageModal({\n\tpreviewedHomepageId,\n\tsetPreviewedHomepageId,\n\tclientId,\n}) {\n\tconst [active, setActive] = useState(false);\n\tconst toggleActive = () => setActive(!active);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Button variant=\"secondary\" onClick={toggleActive}>\n\t\t\t\tCreate New Draft\n\t\t\t</Button>\n\t\t\t{active && (\n\t\t\t\t<EntityCreateNewModal\n\t\t\t\t\t{...{\n\t\t\t\t\t\tentityType: 'homepage',\n\t\t\t\t\t\tdefaultTitle: `Homepage ${today}`,\n\t\t\t\t\t\tdefaultContent: DEFAULT_CONTENT,\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\ttoggleActive();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSubmit: (newTitle, defaultContent) => {\n\t\t\t\t\t\t\tcreateHomepage(\n\t\t\t\t\t\t\t\tnewTitle,\n\t\t\t\t\t\t\t\tdefaultContent,\n\t\t\t\t\t\t\t\t'draft'\n\t\t\t\t\t\t\t).then((response) => {\n\t\t\t\t\t\t\t\tconsole.log('then...', response);\n\t\t\t\t\t\t\t\tsetPreviewedHomepageId(response.id);\n\t\t\t\t\t\t\t\ttoggleActive();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Fragment>\n\t);\n}\n","/**\n * WordPress Dependencies\n */\nimport { store as coreStore } from '@wordpress/core-data';\nimport { dispatch } from '@wordpress/data';\n\n/**\n * Internal Dependencies\n */\nimport { POST_TYPE } from './constants';\n\nexport default async function createHomepage(\n\thomepageTitle,\n\tdefaultContent,\n\tstatus = 'draft'\n) {\n\tconst args = {\n\t\ttitle: homepageTitle,\n\t\tcontent: defaultContent,\n\t\tstatus,\n\t};\n\n\tconst { saveEntityRecord } = dispatch(coreStore);\n\n\tconst newHomepage = await saveEntityRecord('postType', POST_TYPE, args);\n\n\tif (newHomepage) {\n\t\tconsole.log('onCreateHomepage', newHomepage);\n\t\treturn newHomepage;\n\t}\n\n\treturn false;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"i18n\"];","/**\n * External Dependencies\n */\nimport { EntityPatternModal } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { useState, Fragment } from 'react';\nimport { __ } from '@wordpress/i18n';\nimport { Button } from '@wordpress/components';\n\nexport default function PreviewSelectionModal({\n\tpreviewedHomepageId,\n\tsetPreviewedHomepageId,\n\tclientId,\n}) {\n\tconst [active, setActive] = useState(false);\n\tconst toggleActive = () => setActive(!active);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Button variant=\"secondary\" onClick={toggleActive}>\n\t\t\t\tPreview Different Homepage\n\t\t\t</Button>\n\t\t\t{active && (\n\t\t\t\t<EntityPatternModal\n\t\t\t\t\t{...{\n\t\t\t\t\t\ttitle: __(\n\t\t\t\t\t\t\t'Preview an existing homepage',\n\t\t\t\t\t\t\t'prc-platform-homepages'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tinstructions: __(\n\t\t\t\t\t\t\t'Select a homepage to preview',\n\t\t\t\t\t\t\t'prc-platform-homepages'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tentityType: 'homepage',\n\t\t\t\t\t\tentityTypeLabel: __(\n\t\t\t\t\t\t\t'Homepage',\n\t\t\t\t\t\t\t'prc-platform-homepages'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonSelect: (homepage) => {\n\t\t\t\t\t\t\tconsole.log(\"On select\", homepage);\n\t\t\t\t\t\t\tsetPreviewedHomepageId(homepage?.id);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\ttoggleActive();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstatus: 'draft',\n\t\t\t\t\t\tselectedId: previewedHomepageId,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Fragment>\n\t);\n}\n","/**\n * WordPress Dependencies\n */\nimport { InspectorControls } from '@wordpress/block-editor';\nimport { PanelBody, PanelRow } from '@wordpress/components';\n\n/**\n * Internal Dependencies\n */\nimport CreateNewHomepageModal from './create-new-homepage-modal';\nimport PreviewSelectionModal from './preview-selection-modal';\n\nexport default function Controls({\n\tpreviewedHomepageId,\n\tsetPreviewedHomepageId,\n\tclientId,\n}) {\n\treturn (\n\t\t<InspectorControls>\n\t\t\t<PanelBody title=\"Homepage Options\">\n\t\t\t\t<PanelRow>\n\t\t\t\t\t<PreviewSelectionModal\n\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\tpreviewedHomepageId,\n\t\t\t\t\t\t\tsetPreviewedHomepageId,\n\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</PanelRow>\n\t\t\t\t<PanelRow>\n\t\t\t\t\t<CreateNewHomepageModal\n\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\tpreviewedHomepageId,\n\t\t\t\t\t\t\tsetPreviewedHomepageId,\n\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</PanelRow>\n\t\t\t</PanelBody>\n\t\t</InspectorControls>\n\t);\n}\n","/**\n * Registers a new block provided a unique name and an object defining its behavior.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\n\n/**\n * External Dependencies\n */\nimport { home as icon } from '@wordpress/icons';\n\n/**\n * WordPress Dependencies\n */\nimport { registerBlockType } from '@wordpress/blocks';\n\n/**\n * Internal Dependencies\n */\nimport edit from './edit';\nimport metadata from './block.json';\n\nconst { name } = metadata;\n\nconst settings = {\n\ticon,\n\tedit,\n};\n\n/**\n * Every block starts by registering a new block type definition.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\nconst x = registerBlockType(name, { ...metadata, ...settings });\nconsole.log('register homepage:', x);\n","/* eslint-disable @wordpress/i18n-no-variables */\n/* eslint-disable @wordpress/i18n-no-collapsible-whitespace */\n/* eslint-disable @wordpress/no-unsafe-wp-apis */\n/**\n * External Dependencies\n */\nimport { InnerBlocksAsSyncedContent } from '@prc/components';\n\n/**\n * WordPress Dependencies\n */\nimport { Fragment, useMemo, useState, useEffect } from 'react';\nimport { useEntityRecords } from '@wordpress/core-data';\nimport { useBlockProps } from '@wordpress/block-editor';\n\n/**\n * Internal Dependencies\n */\nimport Controls from './controls';\nimport { POST_TYPE, POST_TYPE_LABEL } from './constants';\n\nexport default function Edit({ clientId, context }) {\n\tconst [previewedHomepageId, setPreviewedHomepageId] = useState();\n\n\tconst queryArgs = {\n\t\tper_page: 1,\n\t\tcontext: 'view',\n\t\torderby: 'date',\n\t\torder: 'desc',\n\t};\n\n\tconst { records, hasResolved } = useEntityRecords(\n\t\t'postType',\n\t\tPOST_TYPE,\n\t\tqueryArgs\n\t);\n\n\t// This sets the previewed homepage ID to the first homepage record fetched from the API and updates it if the latest homepage has changed.\n\tuseEffect(() => {\n\t\tif (records?.length === 0 || !hasResolved) {\n\t\t\treturn;\n\t\t}\n\t\t// If there is no previewed homepage or the previewed homepage is different from the one that was just fetched, update the previewed homepage ID.\n\t\tif (records[0].id && previewedHomepageId !== records[0].id) {\n\t\t\tsetPreviewedHomepageId(records[0].id);\n\t\t}\n\t}, [hasResolved, records, previewedHomepageId]);\n\n\tconst blockProps = useBlockProps();\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Controls\n\t\t\t\t{...{\n\t\t\t\t\tpreviewedHomepageId,\n\t\t\t\t\tsetPreviewedHomepageId,\n\t\t\t\t\tclientId,\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<InnerBlocksAsSyncedContent\n\t\t\t\t{...{\n\t\t\t\t\tpostId: previewedHomepageId,\n\t\t\t\t\tpostType: POST_TYPE,\n\t\t\t\t\tpostTypeLabel: POST_TYPE_LABEL,\n\t\t\t\t\tblockProps,\n\t\t\t\t\tclientId,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</Fragment>\n\t);\n}\n"],"names":["window","SVG","xmlns","viewBox","children","Path","d","POST_TYPE","today","Date","toLocaleDateString","month","day","year","CreateNewHomepageModal","previewedHomepageId","setPreviewedHomepageId","clientId","active","setActive","useState","toggleActive","_jsxs","Fragment","_jsx","Button","variant","onClick","EntityCreateNewModal","entityType","defaultTitle","defaultContent","onClose","onSubmit","newTitle","async","homepageTitle","status","args","title","content","saveEntityRecord","dispatch","coreStore","newHomepage","console","log","createHomepage","then","response","id","PreviewSelectionModal","EntityPatternModal","__","instructions","entityTypeLabel","onSelect","homepage","selectedId","Controls","InspectorControls","PanelBody","PanelRow","name","metadata","settings","icon","edit","context","records","hasResolved","useEntityRecords","per_page","orderby","order","useEffect","length","blockProps","useBlockProps","InnerBlocksAsSyncedContent","postId","postType","postTypeLabel","x","registerBlockType"],"sourceRoot":""}